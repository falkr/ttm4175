<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="">
  <meta name="generator" content="">
  <title>TTM4175</title>
  <link rel="canonical" href="https://edu.iik.ntnu.no">
  <!-- Bootstrap core CSS -->
  <link href="../assets/bootstrap.min.css" rel="stylesheet">
  <!-- Custom styles for this template -->
  <link href="../assets/style.css" rel="stylesheet">
  <link rel="stylesheet" href="../assets/bootstrap-icons.css">
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
  <script src="../assets/anchor.js"></script>
  <script src="../assets/script-aside.js"></script>
  <script src="../assets/clipboard.min.js"></script>
  <style type="text/css">
    /* === figure === */
div.figure {
  padding: 20px 0 20px 0;
  width: 100%;
}

div.figurefullwitdth {
  padding: 20px 0 20px 0;
  margin-left: -33px;
  margin-right: -33px;
  width: 100%;
}

figcaption {
  color: #868279;
}

/* === goals === */
div.goals ul,
div.goals ul li {
  padding: 0;
  margin: 0;
  list-style: none;
}

div.goals ul {
  margin: 2em 0;
}

div.goals ul li {
  margin: 1em;
  margin-left: 3em;
}

div.goals ul li:before {
  content: '\f3cb';
  font-family: bootstrap-icons !important;
  font-size: 20;
  float: left;
  margin-left: -1.5em;
  color: #00509e;
}

/* === hints === */
.w3collapsible {
  background-color: #f0e9db;
  color: #868279;
  padding: 8px 18px 8px 8px;
  cursor: pointer;
  width: 100%;
  border: none;
  border-radius: 3px 3px 0 0;
  text-align: left;
  outline: none;
  font-size: 15px;
}

.w3active,
.w3collapsible:hover {
  background-color: #f0e9cb;
}

.w3content {
  filter: blur(3px);
  padding: 18px;
  display: block;
  overflow: hidden;
  background-color: #f3f3f3;
  margin-bottom: 15px;
}


  </style>
</head>

<body>
  
  



<nav class="navbar navbar-expand-lg navbar shadow-sm">
  <div class="container-fluid">
    <a class="navbar-brand" href="https://ntnu.edu" title="NTNU Homepage">
      <img id="header_logo" alt="NTNU Hjemmeside" width="120px" src="https://www.ntnu.no/o/ntnu-theme/images/logo_ntnu.svg" height="23px">
    </a>
    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon">
      	<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-list" viewBox="0 0 16 16">
  			<path fill-rule="evenodd" d="M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5z"/>
		</svg>
      </span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNavDropdown">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link" href="../index.html">TTM4175</a>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            Teknostart
          </a>
          <ul class="dropdown-menu dropdown-menu">
            <a class="dropdown-item" href="../teknostart/index.html">Teknostart oversikt</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="../teknostart/day1.html">Teknostart Dag 1</a>
            <a class="dropdown-item" href="../teknostart/day2.html">Teknostart Dag 2</a>
            <a class="dropdown-item" href="../teknostart/day3.html">Teknostart Dag 3</a>
            <a class="dropdown-item" href="../teknostart/day4.html">Teknostart Dag 4</a>
          </ul>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            Units
          </a>
          <ul class="dropdown-menu dropdown-menu">
            <a class="dropdown-item" href="../units.html">Oversikt</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="../unit-cli/index.html">Linux CLI</a>
            <a class="dropdown-item" href="../unit-net1/index.html">IPs, LAN</a>
            <a class="dropdown-item" href="../unit-net2/index.html">Ports, Web Servers</a>
            <a class="dropdown-item" href="../unit-net3/index.html">Routing, DNS</a>
            <a class="dropdown-item" href="../unit-p1/index.html">IoT and the Microbit</a>
            <a class="dropdown-item" href="../unit-p2/index.html">State Machines</a>
            <a class="dropdown-item" href="../unit-p3/index.html">HTTP and JSON</a>
            <a class="dropdown-item" href="../unit-p4/index.html">MQTT</a>
          </ul>
        </li>
        
        

        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            Learning
          </a>
          <ul class="dropdown-menu dropdown-menu">
            <a class="dropdown-item" href="../learning/learning.html">LÃ¦ring</a>
            <a class="dropdown-item" href="../learning/reports.html">Rapporter</a>
          </ul>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            Tools
          </a>
          <ul class="dropdown-menu dropdown-menu">
            <a class="dropdown-item" href="../tools/index.html">Tools</a>
            <!--<a class="dropdown-item" href="../tools/tools-python.html">Python</a>-->
            <a class="dropdown-item" href="../tools/tools-gui.html">GUIs in Python</a>    
            <a class="dropdown-item" href="../tools/tools-mqtt.html">MQTT</a>            
            <a class="dropdown-item" href="../tools/tools-notebooks.html">Notebooks</a>
            <a class="dropdown-item" href="../tools/tools-stmpy.html">STMPY</a>            
          </ul>
        </li>
      </ul>
      <div class="bg-light border ms-auto"></div>
        <div>
        <a class="nav-link" href="../schedule.html"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-calendar3" viewBox="0 0 16 16">
          <path d="M14 0H2a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2zM1 3.857C1 3.384 1.448 3 2 3h12c.552 0 1 .384 1 .857v10.286c0 .473-.448.857-1 .857H2c-.552 0-1-.384-1-.857V3.857z"/>
          <path d="M6.5 7a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm-9 3a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm-9 3a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"/>
        </svg></a>
      </div>
    </div>
  </div>
</nav>






  <main class="container">

    <div class="row g-5 justify-content-md-center pb-5">



      <div class="col-md-9" style="margin-top: 6rem;">
        <div class="page">
    </section>
    <section class="content">
<h1>Lab: State Machines on the Microbit</h1>

<h3>Overview of Tasks</h3>
<p>We have created 5 tasks which all let you solve a slightly different problem related to state machines.
The tasks are independent of each other, but the first one is the easiest to get started and the last one is maybe a bit challenging.</p>
<p>Here's an overview:</p>
<ol>
<li><strong>Counter</strong>: You run the example, just to check that all works, and explain the behavior in words.</li>
<li><strong>Shake Light</strong>: Create a state machine diagram from code.</li>
<li><strong>Night Light</strong>: Extend a state machine diagram, and extend its code.</li>
<li><strong>Switch Light</strong>: You get the state machine diagram, but build all code on your own.</li>
<li><strong>Hand Sanitizer Station</strong>: You create state machine diagram and code by yourself from a textual description.</li>
</ol>
<p>All background theory for the tasks is covered in this page about <a href="prep-iot-stm.html">State machines</a> in general and <a href="prep-iot-stmpy.html">State machines in Micro Python</a>.</p>

<h3>Drawing State Machine Diagrams</h3>
<p>You will need to draw some diagrams in this lab.</p>
<ul>
<li><strong>Pencil and paper</strong> are probably still the best tools for sketching a state machine when you are working on your own. Don't underestimate the value of making quick sketches and iterating on them before you make an electronic version of your diagram for documentation.</li>
<li><strong>Whiteboards or blackboards</strong> have the benefit that you can work in groups, if you are physically at the same place.</li>
<li><strong>Drawing applications</strong> are often easy to access and use, but do not know that you want to create a special diagram style. Though this is probably your best option. You can create simple state machine diagrams in a shared PowerPoint, to which you have access in Teams. Another option is <a href="draw.io">Draw.io</a>, but it requires you to login with a Google account.</li>
</ul>

<h3>Working Style</h3>
<p>There is not a lot to program today in counting the lines of code. The goal is rather to train an approach to system development and problem exploration --- the state machines and Python code are just tools to get there. Therefore:</p>
<ul>
<li>Make sure at each one in your team follows. In this lab, make sure you are familiar with all the details, and can follow everything. If not all points are clear to everyone, ask your team mates, or vice-versa, explain it to them.</li>
<li>For each task, give everyone a few minutes to think individually. You can only have valuable team discussions if everyone had the chance to think on their own first.</li>
</ul>

    </section>
    <section class="content">
<h1>Task 1: Counter</h1>

<div class="goals"><ul>
<li><strong>Goal:</strong> Get the state machine code running, to check that all works.</li>
</ul>
<p>Below you find the complete code of an counter based on a state machine. The code contains four parts:</p>
<ol>
<li>the import statements,</li>
<li>the basis code for the state machine,</li>
<li>the extended state machine, here the actual counter,</li>
<li>the code to start the counter</li>
</ol>
<p>In the following, you will usually only copy the base state machine (2) and work on the code for the extended state machine (3), including how to start it (4). Sometimes you may want to adjust the import statements if you need access to more elements.</p>
</div>
<div class="source-code-frame mt-3 mb-3">
<pre class="d-none" id="id074a9d"># 1 import statements
from utime import ticks_ms
from microbit import button_a, button_b, accelerometer, display, sleep, Image

ON = Image.SQUARE
OFF = Image.SQUARE_SMALL

# 2 base state machine
class StateMachine:
    """
    The following code segment defines a basis state machine.
    Leave this code as it is. (Or be careful what you do.)"""

    def __init__(self, timer_names=["t1", "t2", "t3"]):
        self.active = False
        self.state = "initial"
        self.timer_names = timer_names
        self.timers = {}

    def _ticks_ms(self):
        # return int(round(time() * 1000))
        return ticks_ms()

    def initial_transition(self, timers):
        """Overwrite this method to define the initial transition.
        Must return the name of the first state."""
        return None

    def transition(self, state, event, timers):
        """Overwrite this method to define the transitions.

        `state` - the current state
        `event` - the triggering event
        `timers` - to start and stop timers

        Return the name of the next state,
        or None to stay in current state."""
        return None

    def start(self, name, timeout):
        """Start a timer.
        The name must be t1, t2 or t2.
        The timeout is given in milliseconds.
        """
        self.timers[name] = self._ticks_ms() + timeout

    def stop(self, name):
        """Stop a timer."""
        self.timers[name] = None

    def _detect_event(self):
        now = self._ticks_ms()
        for timer in self.timer_names:
            if (timer in self.timers) and (self.timers[timer] is not None):
                if self.timers[timer] < now:
                    self.timers[timer] = None
                    return timer
        if button_a.was_pressed():
            return "button_a"
        if button_b.was_pressed():
            return "button_b"
        if accelerometer.was_gesture("shake"):
            return "shake"
        return None

    def run(self):
        """Run the state machine."""
        self.active = True
        while self.active:
            if self.state == "initial":
                next_state = self.initial_transition(self)
                if next_state:
                    if next_state == "final":
                        self.active = False
                    self.state = next_state
            event = self._detect_event()
            if event is not None:
                next_state = self.transition(self.state, event, self)
                if next_state:
                    self.state = next_state
            sleep(100)

# 3 the extended state machine
class Counter(StateMachine):
    """Counting the number of clicks on button A.
    If 10 is reached, an "alarm" is shown by switching all LEDs on.
    The counter can be reset at any time with button B.
    """

    def initial_transition(self, timers):
        self.counter = 0
        display.show(self.counter)
        return "count"

    def transition(self, state, event, timers):
        if state == "count":
            if event == "button_a":
                if self.counter < 9:
                    self.counter = self.counter + 1
                    display.show(self.counter)
                    return "count"
                else:
                    display.show(ON)
                    timers.start("t1", 1000)
                    return "alarm"
            elif event == "button_b":
                self.counter = 0
                display.show(self.counter)
                return "count"
        elif state == "alarm":
            if event == "t1":
                self.counter = 0
                display.show(self.counter)
                return "count"

# 4 starting the machine
stm = Counter()
stm.run()
</pre>
<button type="button" class="copy-button" data-clipboard-target="#id074a9d">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16">
  		<path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"></path>
  		<path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"></path>
	</svg>
</button>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># 1 import statements</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="im">from</span> utime <span class="im">import</span> ticks_ms</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="im">from</span> microbit <span class="im">import</span> button_a, button_b, accelerometer, display, sleep, Image</a>
<a class="sourceLine" id="cb1-4" title="4"></a>
<a class="sourceLine" id="cb1-5" title="5">ON <span class="op">=</span> Image.SQUARE</a>
<a class="sourceLine" id="cb1-6" title="6">OFF <span class="op">=</span> Image.SQUARE_SMALL</a>
<a class="sourceLine" id="cb1-7" title="7"></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="co"># 2 base state machine</span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="kw">class</span> StateMachine:</a>
<a class="sourceLine" id="cb1-10" title="10">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="co">    The following code segment defines a basis state machine.</span></a>
<a class="sourceLine" id="cb1-12" title="12"><span class="co">    Leave this code as it is. (Or be careful what you do.)&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1-13" title="13"></a>
<a class="sourceLine" id="cb1-14" title="14">    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, timer_names<span class="op">=</span>[<span class="st">&quot;t1&quot;</span>, <span class="st">&quot;t2&quot;</span>, <span class="st">&quot;t3&quot;</span>]):</a>
<a class="sourceLine" id="cb1-15" title="15">        <span class="va">self</span>.active <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb1-16" title="16">        <span class="va">self</span>.state <span class="op">=</span> <span class="st">&quot;initial&quot;</span></a>
<a class="sourceLine" id="cb1-17" title="17">        <span class="va">self</span>.timer_names <span class="op">=</span> timer_names</a>
<a class="sourceLine" id="cb1-18" title="18">        <span class="va">self</span>.timers <span class="op">=</span> {}</a>
<a class="sourceLine" id="cb1-19" title="19"></a>
<a class="sourceLine" id="cb1-20" title="20">    <span class="kw">def</span> _ticks_ms(<span class="va">self</span>):</a>
<a class="sourceLine" id="cb1-21" title="21">        <span class="co"># return int(round(time() * 1000))</span></a>
<a class="sourceLine" id="cb1-22" title="22">        <span class="cf">return</span> ticks_ms()</a>
<a class="sourceLine" id="cb1-23" title="23"></a>
<a class="sourceLine" id="cb1-24" title="24">    <span class="kw">def</span> initial_transition(<span class="va">self</span>, timers):</a>
<a class="sourceLine" id="cb1-25" title="25">        <span class="co">&quot;&quot;&quot;Overwrite this method to define the initial transition.</span></a>
<a class="sourceLine" id="cb1-26" title="26"><span class="co">        Must return the name of the first state.&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1-27" title="27">        <span class="cf">return</span> <span class="va">None</span></a>
<a class="sourceLine" id="cb1-28" title="28"></a>
<a class="sourceLine" id="cb1-29" title="29">    <span class="kw">def</span> transition(<span class="va">self</span>, state, event, timers):</a>
<a class="sourceLine" id="cb1-30" title="30">        <span class="co">&quot;&quot;&quot;Overwrite this method to define the transitions.</span></a>
<a class="sourceLine" id="cb1-31" title="31"></a>
<a class="sourceLine" id="cb1-32" title="32"><span class="co">        `state` - the current state</span></a>
<a class="sourceLine" id="cb1-33" title="33"><span class="co">        `event` - the triggering event</span></a>
<a class="sourceLine" id="cb1-34" title="34"><span class="co">        `timers` - to start and stop timers</span></a>
<a class="sourceLine" id="cb1-35" title="35"></a>
<a class="sourceLine" id="cb1-36" title="36"><span class="co">        Return the name of the next state,</span></a>
<a class="sourceLine" id="cb1-37" title="37"><span class="co">        or None to stay in current state.&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1-38" title="38">        <span class="cf">return</span> <span class="va">None</span></a>
<a class="sourceLine" id="cb1-39" title="39"></a>
<a class="sourceLine" id="cb1-40" title="40">    <span class="kw">def</span> start(<span class="va">self</span>, name, timeout):</a>
<a class="sourceLine" id="cb1-41" title="41">        <span class="co">&quot;&quot;&quot;Start a timer.</span></a>
<a class="sourceLine" id="cb1-42" title="42"><span class="co">        The name must be t1, t2 or t2.</span></a>
<a class="sourceLine" id="cb1-43" title="43"><span class="co">        The timeout is given in milliseconds.</span></a>
<a class="sourceLine" id="cb1-44" title="44"><span class="co">        &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1-45" title="45">        <span class="va">self</span>.timers[name] <span class="op">=</span> <span class="va">self</span>._ticks_ms() <span class="op">+</span> timeout</a>
<a class="sourceLine" id="cb1-46" title="46"></a>
<a class="sourceLine" id="cb1-47" title="47">    <span class="kw">def</span> stop(<span class="va">self</span>, name):</a>
<a class="sourceLine" id="cb1-48" title="48">        <span class="co">&quot;&quot;&quot;Stop a timer.&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1-49" title="49">        <span class="va">self</span>.timers[name] <span class="op">=</span> <span class="va">None</span></a>
<a class="sourceLine" id="cb1-50" title="50"></a>
<a class="sourceLine" id="cb1-51" title="51">    <span class="kw">def</span> _detect_event(<span class="va">self</span>):</a>
<a class="sourceLine" id="cb1-52" title="52">        now <span class="op">=</span> <span class="va">self</span>._ticks_ms()</a>
<a class="sourceLine" id="cb1-53" title="53">        <span class="cf">for</span> timer <span class="kw">in</span> <span class="va">self</span>.timer_names:</a>
<a class="sourceLine" id="cb1-54" title="54">            <span class="cf">if</span> (timer <span class="kw">in</span> <span class="va">self</span>.timers) <span class="kw">and</span> (<span class="va">self</span>.timers[timer] <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>):</a>
<a class="sourceLine" id="cb1-55" title="55">                <span class="cf">if</span> <span class="va">self</span>.timers[timer] <span class="op">&lt;</span> now:</a>
<a class="sourceLine" id="cb1-56" title="56">                    <span class="va">self</span>.timers[timer] <span class="op">=</span> <span class="va">None</span></a>
<a class="sourceLine" id="cb1-57" title="57">                    <span class="cf">return</span> timer</a>
<a class="sourceLine" id="cb1-58" title="58">        <span class="cf">if</span> button_a.was_pressed():</a>
<a class="sourceLine" id="cb1-59" title="59">            <span class="cf">return</span> <span class="st">&quot;button_a&quot;</span></a>
<a class="sourceLine" id="cb1-60" title="60">        <span class="cf">if</span> button_b.was_pressed():</a>
<a class="sourceLine" id="cb1-61" title="61">            <span class="cf">return</span> <span class="st">&quot;button_b&quot;</span></a>
<a class="sourceLine" id="cb1-62" title="62">        <span class="cf">if</span> accelerometer.was_gesture(<span class="st">&quot;shake&quot;</span>):</a>
<a class="sourceLine" id="cb1-63" title="63">            <span class="cf">return</span> <span class="st">&quot;shake&quot;</span></a>
<a class="sourceLine" id="cb1-64" title="64">        <span class="cf">return</span> <span class="va">None</span></a>
<a class="sourceLine" id="cb1-65" title="65"></a>
<a class="sourceLine" id="cb1-66" title="66">    <span class="kw">def</span> run(<span class="va">self</span>):</a>
<a class="sourceLine" id="cb1-67" title="67">        <span class="co">&quot;&quot;&quot;Run the state machine.&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1-68" title="68">        <span class="va">self</span>.active <span class="op">=</span> <span class="va">True</span></a>
<a class="sourceLine" id="cb1-69" title="69">        <span class="cf">while</span> <span class="va">self</span>.active:</a>
<a class="sourceLine" id="cb1-70" title="70">            <span class="cf">if</span> <span class="va">self</span>.state <span class="op">==</span> <span class="st">&quot;initial&quot;</span>:</a>
<a class="sourceLine" id="cb1-71" title="71">                next_state <span class="op">=</span> <span class="va">self</span>.initial_transition(<span class="va">self</span>)</a>
<a class="sourceLine" id="cb1-72" title="72">                <span class="cf">if</span> next_state:</a>
<a class="sourceLine" id="cb1-73" title="73">                    <span class="cf">if</span> next_state <span class="op">==</span> <span class="st">&quot;final&quot;</span>:</a>
<a class="sourceLine" id="cb1-74" title="74">                        <span class="va">self</span>.active <span class="op">=</span> <span class="va">False</span></a>
<a class="sourceLine" id="cb1-75" title="75">                    <span class="va">self</span>.state <span class="op">=</span> next_state</a>
<a class="sourceLine" id="cb1-76" title="76">            event <span class="op">=</span> <span class="va">self</span>._detect_event()</a>
<a class="sourceLine" id="cb1-77" title="77">            <span class="cf">if</span> event <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</a>
<a class="sourceLine" id="cb1-78" title="78">                next_state <span class="op">=</span> <span class="va">self</span>.transition(<span class="va">self</span>.state, event, <span class="va">self</span>)</a>
<a class="sourceLine" id="cb1-79" title="79">                <span class="cf">if</span> next_state:</a>
<a class="sourceLine" id="cb1-80" title="80">                    <span class="va">self</span>.state <span class="op">=</span> next_state</a>
<a class="sourceLine" id="cb1-81" title="81">            sleep(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb1-82" title="82"></a>
<a class="sourceLine" id="cb1-83" title="83"><span class="co"># 3 the extended state machine</span></a>
<a class="sourceLine" id="cb1-84" title="84"><span class="kw">class</span> Counter(StateMachine):</a>
<a class="sourceLine" id="cb1-85" title="85">    <span class="co">&quot;&quot;&quot;Counting the number of clicks on button A.</span></a>
<a class="sourceLine" id="cb1-86" title="86"><span class="co">    If 10 is reached, an &quot;alarm&quot; is shown by switching all LEDs on.</span></a>
<a class="sourceLine" id="cb1-87" title="87"><span class="co">    The counter can be reset at any time with button B.</span></a>
<a class="sourceLine" id="cb1-88" title="88"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1-89" title="89"></a>
<a class="sourceLine" id="cb1-90" title="90">    <span class="kw">def</span> initial_transition(<span class="va">self</span>, timers):</a>
<a class="sourceLine" id="cb1-91" title="91">        <span class="va">self</span>.counter <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1-92" title="92">        display.show(<span class="va">self</span>.counter)</a>
<a class="sourceLine" id="cb1-93" title="93">        <span class="cf">return</span> <span class="st">&quot;count&quot;</span></a>
<a class="sourceLine" id="cb1-94" title="94"></a>
<a class="sourceLine" id="cb1-95" title="95">    <span class="kw">def</span> transition(<span class="va">self</span>, state, event, timers):</a>
<a class="sourceLine" id="cb1-96" title="96">        <span class="cf">if</span> state <span class="op">==</span> <span class="st">&quot;count&quot;</span>:</a>
<a class="sourceLine" id="cb1-97" title="97">            <span class="cf">if</span> event <span class="op">==</span> <span class="st">&quot;button_a&quot;</span>:</a>
<a class="sourceLine" id="cb1-98" title="98">                <span class="cf">if</span> <span class="va">self</span>.counter <span class="op">&lt;</span> <span class="dv">9</span>:</a>
<a class="sourceLine" id="cb1-99" title="99">                    <span class="va">self</span>.counter <span class="op">=</span> <span class="va">self</span>.counter <span class="op">+</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb1-100" title="100">                    display.show(<span class="va">self</span>.counter)</a>
<a class="sourceLine" id="cb1-101" title="101">                    <span class="cf">return</span> <span class="st">&quot;count&quot;</span></a>
<a class="sourceLine" id="cb1-102" title="102">                <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1-103" title="103">                    display.show(ON)</a>
<a class="sourceLine" id="cb1-104" title="104">                    timers.start(<span class="st">&quot;t1&quot;</span>, <span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb1-105" title="105">                    <span class="cf">return</span> <span class="st">&quot;alarm&quot;</span></a>
<a class="sourceLine" id="cb1-106" title="106">            <span class="cf">elif</span> event <span class="op">==</span> <span class="st">&quot;button_b&quot;</span>:</a>
<a class="sourceLine" id="cb1-107" title="107">                <span class="va">self</span>.counter <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1-108" title="108">                display.show(<span class="va">self</span>.counter)</a>
<a class="sourceLine" id="cb1-109" title="109">                <span class="cf">return</span> <span class="st">&quot;count&quot;</span></a>
<a class="sourceLine" id="cb1-110" title="110">        <span class="cf">elif</span> state <span class="op">==</span> <span class="st">&quot;alarm&quot;</span>:</a>
<a class="sourceLine" id="cb1-111" title="111">            <span class="cf">if</span> event <span class="op">==</span> <span class="st">&quot;t1&quot;</span>:</a>
<a class="sourceLine" id="cb1-112" title="112">                <span class="va">self</span>.counter <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb1-113" title="113">                display.show(<span class="va">self</span>.counter)</a>
<a class="sourceLine" id="cb1-114" title="114">                <span class="cf">return</span> <span class="st">&quot;count&quot;</span></a>
<a class="sourceLine" id="cb1-115" title="115"></a>
<a class="sourceLine" id="cb1-116" title="116"><span class="co"># 4 starting the machine</span></a>
<a class="sourceLine" id="cb1-117" title="117">stm <span class="op">=</span> Counter()</a>
<a class="sourceLine" id="cb1-118" title="118">stm.run()</a></code></pre></div>
</div>
<h3>Diagram for the Counter</h3>

<figure class="figure">
    <img src="figures/counter.svg" class="figure-img img-fluid rounded" alt="">
</figure>
<p>The counter is an electronic version of a hand counter, like the one they use on airplanes to count how many passengers are on board. Ours is made for very small planes --- it can only count to 10.</p>
<h3>Run the Counter</h3>
<p>Run the counter on the Microbit, and try out if the counter works as you have described.</p>
<p><strong>Task:</strong> Inspect the diagram closely, and describe in words how you expect, the counter will work.</p>
<ul>
<li>Include this description in your report. Make sure to include all details.</li>
<li>What is the function of <code>button_b</code>?</li>
<li>In addition to the textual description, illustrate the functions of the counter using a series of small screenshots.</li>
</ul>

    </section>
    <section class="content">
<h1>Task 2: Shake Light</h1>

<div class="goals"><ul>
<li><strong>Goal:</strong> Create a state machine diagram from given code.</li>
</ul>
</div>
<p>Have a look at the code below, and run it. (We here only show the code of the extended state machine for the shake light, remember to keep the code for the base state machine and the import statements.)</p>

<div class="source-code-frame mt-3 mb-3">
<pre class="d-none" id="idd820cb">class ShakeLight(StateMachine):
    """Switch on the light if you shake the device
    and turn it off again after 2 seconds.
    """

    def initial_transition(self, timers):
        display.show(Image.SQUARE_SMALL)
        return "off"

    def transition(self, state, event, timers):
        if state == "off":
            if event == "shake":
                display.show(Image.SQUARE)
                timers.start("t1", 2000)
                return "on"
        elif state == "on":
            if event == "t1":
                display.show(Image.SQUARE_SMALL)
                return "off"
</pre>
<button type="button" class="copy-button" data-clipboard-target="#idd820cb">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16">
  		<path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"></path>
  		<path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"></path>
	</svg>
</button>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">class</span> ShakeLight(StateMachine):</a>
<a class="sourceLine" id="cb1-2" title="2">    <span class="co">&quot;&quot;&quot;Switch on the light if you shake the device</span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="co">    and turn it off again after 2 seconds.</span></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1-5" title="5"></a>
<a class="sourceLine" id="cb1-6" title="6">    <span class="kw">def</span> initial_transition(<span class="va">self</span>, timers):</a>
<a class="sourceLine" id="cb1-7" title="7">        display.show(Image.SQUARE_SMALL)</a>
<a class="sourceLine" id="cb1-8" title="8">        <span class="cf">return</span> <span class="st">&quot;off&quot;</span></a>
<a class="sourceLine" id="cb1-9" title="9"></a>
<a class="sourceLine" id="cb1-10" title="10">    <span class="kw">def</span> transition(<span class="va">self</span>, state, event, timers):</a>
<a class="sourceLine" id="cb1-11" title="11">        <span class="cf">if</span> state <span class="op">==</span> <span class="st">&quot;off&quot;</span>:</a>
<a class="sourceLine" id="cb1-12" title="12">            <span class="cf">if</span> event <span class="op">==</span> <span class="st">&quot;shake&quot;</span>:</a>
<a class="sourceLine" id="cb1-13" title="13">                display.show(Image.SQUARE)</a>
<a class="sourceLine" id="cb1-14" title="14">                timers.start(<span class="st">&quot;t1&quot;</span>, <span class="dv">2000</span>)</a>
<a class="sourceLine" id="cb1-15" title="15">                <span class="cf">return</span> <span class="st">&quot;on&quot;</span></a>
<a class="sourceLine" id="cb1-16" title="16">        <span class="cf">elif</span> state <span class="op">==</span> <span class="st">&quot;on&quot;</span>:</a>
<a class="sourceLine" id="cb1-17" title="17">            <span class="cf">if</span> event <span class="op">==</span> <span class="st">&quot;t1&quot;</span>:</a>
<a class="sourceLine" id="cb1-18" title="18">                display.show(Image.SQUARE_SMALL)</a>
<a class="sourceLine" id="cb1-19" title="19">                <span class="cf">return</span> <span class="st">&quot;off&quot;</span></a></code></pre></div>
</div>
<p><strong>Task:</strong> First, describe the behavior of the shake light in a few sentences.</p>

<p><strong>Task:</strong> Draw a state machine that corresponds to the code. Make sure to include all necessary elements.</p>

    </section>
    <section class="content">
<h1>Night Light</h1>

<div class="goals"><ul>
<li><strong>Goal:</strong> Extend a given diagram to extends its functionality, and extend the corresponding code.</li>
</ul>
</div>
<figure class="figure">
    <img src="figures/stm-night-light-1.svg" class="figure-img img-fluid rounded" alt="">
</figure>
<p>Above you see the partial state machine of a night light, which depends on the light level, and switches on when it reaches &gt; 100.</p>
<p><strong>Task:</strong> Describe the behavior of the shake light in a few sentences.</p>
<p><strong>Task:</strong> Extend the state machine diagram so that it also switches the light off again after the level goes under 80.</p>
<p><strong>Task:</strong> Add the code for the added functionality and check that it works. Include a series of small screenshots in your report.</p>

<div class="source-code-frame mt-3 mb-3">
<pre class="d-none" id="id5d0cc6">class NightLight(StateMachine):
    """Periodically read the light level.
    If the light level is above 100, switch on the light.
    If it is below 80, switch the light off again.
    """

    def initial_transition(self, timers):
        display.show(Image.SQUARE_SMALL)
        timers.start("t1", 1000)
        return "off"

    def transition(self, state, event, timers):
        if state == "off":
            if event == "t1":
                if display.read_light_level() > 100:
                    display.show(Image.SQUARE)
                    timers.start("t1", 1000)
                    return "on"
                else:
                    timers.start("t1", 1000)
                    return "off"


stm = NightLight()
stm.run()
</pre>
<button type="button" class="copy-button" data-clipboard-target="#id5d0cc6">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16">
  		<path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"></path>
  		<path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"></path>
	</svg>
</button>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">class</span> NightLight(StateMachine):</a>
<a class="sourceLine" id="cb1-2" title="2">    <span class="co">&quot;&quot;&quot;Periodically read the light level.</span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="co">    If the light level is above 100, switch on the light.</span></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="co">    If it is below 80, switch the light off again.</span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1-6" title="6"></a>
<a class="sourceLine" id="cb1-7" title="7">    <span class="kw">def</span> initial_transition(<span class="va">self</span>, timers):</a>
<a class="sourceLine" id="cb1-8" title="8">        display.show(Image.SQUARE_SMALL)</a>
<a class="sourceLine" id="cb1-9" title="9">        timers.start(<span class="st">&quot;t1&quot;</span>, <span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb1-10" title="10">        <span class="cf">return</span> <span class="st">&quot;off&quot;</span></a>
<a class="sourceLine" id="cb1-11" title="11"></a>
<a class="sourceLine" id="cb1-12" title="12">    <span class="kw">def</span> transition(<span class="va">self</span>, state, event, timers):</a>
<a class="sourceLine" id="cb1-13" title="13">        <span class="cf">if</span> state <span class="op">==</span> <span class="st">&quot;off&quot;</span>:</a>
<a class="sourceLine" id="cb1-14" title="14">            <span class="cf">if</span> event <span class="op">==</span> <span class="st">&quot;t1&quot;</span>:</a>
<a class="sourceLine" id="cb1-15" title="15">                <span class="cf">if</span> display.read_light_level() <span class="op">&gt;</span> <span class="dv">100</span>:</a>
<a class="sourceLine" id="cb1-16" title="16">                    display.show(Image.SQUARE)</a>
<a class="sourceLine" id="cb1-17" title="17">                    timers.start(<span class="st">&quot;t1&quot;</span>, <span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb1-18" title="18">                    <span class="cf">return</span> <span class="st">&quot;on&quot;</span></a>
<a class="sourceLine" id="cb1-19" title="19">                <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1-20" title="20">                    timers.start(<span class="st">&quot;t1&quot;</span>, <span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb1-21" title="21">                    <span class="cf">return</span> <span class="st">&quot;off&quot;</span></a>
<a class="sourceLine" id="cb1-22" title="22"></a>
<a class="sourceLine" id="cb1-23" title="23"></a>
<a class="sourceLine" id="cb1-24" title="24">stm <span class="op">=</span> NightLight()</a>
<a class="sourceLine" id="cb1-25" title="25">stm.run()</a></code></pre></div>
</div>
    </section>
    <section class="content">
<h1>Switch Light</h1>

<div class="goals"><ul>
<li><strong>Goal:</strong> Build all code on your own from a given state machine diagram.</li>
</ul>
</div>
<figure class="figure">
    <img src="figures/stm-switch-light.svg" class="figure-img img-fluid rounded" alt="">
</figure>
<p>Above is the diagram for a light that can be switched on and off.</p>
<p><strong>Task:</strong> Have a close look at the diagram, and describe what it does in words.</p>
<p><strong>Task:</strong> Build the entire code for the state machine.</p>
<ul>
<li>Use the code given below as starter (remember to add the import statements and the base state machine from above).</li>
<li>You only have to fill the content of the functions <code>initial_transition</code> and <code>transition</code>.</li>
</ul>

<div class="source-code-frame mt-3 mb-3">
<pre class="d-none" id="id98dd91">class SwitchLight(StateMachine):
"""Switch between states off and on by pressing button A.

The change between on and off only happens if button A is pressed
twice quickly.

State off is represented by a small square,
state on with a big square.

The transitional states between on and off are shown
with arrows up and down.
"""

def initial_transition(self, timers):
    # add your code here

def transition(self, state, event, timers):
    # add your code here


stm = SwitchLight()
stm.run()
</pre>
<button type="button" class="copy-button" data-clipboard-target="#id98dd91">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16">
  		<path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"></path>
  		<path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"></path>
	</svg>
</button>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">class</span> SwitchLight(StateMachine):</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="co">&quot;&quot;&quot;Switch between states off and on by pressing button A.</span></a>
<a class="sourceLine" id="cb1-3" title="3"></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="co">The change between on and off only happens if button A is pressed</span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="co">twice quickly.</span></a>
<a class="sourceLine" id="cb1-6" title="6"></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="co">State off is represented by a small square,</span></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="co">state on with a big square.</span></a>
<a class="sourceLine" id="cb1-9" title="9"></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="co">The transitional states between on and off are shown</span></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="co">with arrows up and down.</span></a>
<a class="sourceLine" id="cb1-12" title="12"><span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb1-13" title="13"></a>
<a class="sourceLine" id="cb1-14" title="14"><span class="kw">def</span> initial_transition(<span class="va">self</span>, timers):</a>
<a class="sourceLine" id="cb1-15" title="15">    <span class="co"># add your code here</span></a>
<a class="sourceLine" id="cb1-16" title="16"></a>
<a class="sourceLine" id="cb1-17" title="17"><span class="kw">def</span> transition(<span class="va">self</span>, state, event, timers):</a>
<a class="sourceLine" id="cb1-18" title="18">    <span class="co"># add your code here</span></a>
<a class="sourceLine" id="cb1-19" title="19"></a>
<a class="sourceLine" id="cb1-20" title="20"></a>
<a class="sourceLine" id="cb1-21" title="21">stm <span class="op">=</span> SwitchLight()</a>
<a class="sourceLine" id="cb1-22" title="22">stm.run()</a></code></pre></div>
</div>
    </section>
    <section class="content">
<h1>Hand Sanitizer Station</h1>

<div class="goals"><ul>
<li><strong>Goal:</strong> Create diagram and code by yourself.</li>
</ul>
</div>
<figure class="figure">
    <img src="figures/dispenser.png" class="figure-img img-fluid rounded" alt="">
</figure>
<p>Create the state machine for a hand sanitizer.
These machines, as you know, detect that someone puts their hand under the dispenser, then run a motor for 800 milliseconds to dispense some sanitizer.</p>
<p>To avoid double-dispensing, the machine ignores a repeated dispensing for about 2 seconds, that means, you need to wait for 2 seconds before it dispenses another load. (Sometimes irritating if you want a double dose...)</p>
<p><strong>Task:</strong> Create such a state machine diagram.</p>
<ul>
<li>Try to sketch one on your own, each one individually for a few minutes.</li>
<li>Compare your solutions.</li>
<li>Use the state machines to understand the function better. Do you all agree on what the system should <em>exactly</em> do?</li>
</ul>
<p>Some hints:</p>
<ul>
<li>Assume that a detected hand is signalled by event <code>shake</code>. That means, if the shale event is detected, the dispenser should dispense a dose by switching on its motor.</li>
<li>Instead of switching on a motor, just show an arrow pointing downwards (<code>Image.ARROW_S</code>) on the display.</li>
<li>Make sure it does activate the dispenser (by showing the arrow) for the 800 milliseconds.</li>
<li>Make sure it does not double dispense within 2 seconds after the first detected shake.</li>
</ul>

<button class="w3collapsible">Hint about the states. (Click only when you need it.)</button>
<div class="w3content">
<p>The state machine we came up with has three control states, which we called for <code>ready</code>, <code>dispensing</code> and <code>blocked</code>. The names do not matter, but may indicate what happens in them.</p>

</div>
<p><strong>Task:</strong> Create the code for the machines. Use below below as starting point.</p>

<div class="source-code-frame mt-3 mb-3">
<pre class="d-none" id="ida3261a">class Dispenser(StateMachine):
    
    def initial_transition(self, timers):
        # define your initial transition here

    def transition(self, state, event, timers):
        # define your transitions here

stm = Dispenser()
stm.run()
</pre>
<button type="button" class="copy-button" data-clipboard-target="#ida3261a">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16">
  		<path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"></path>
  		<path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"></path>
	</svg>
</button>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">class</span> Dispenser(StateMachine):</a>
<a class="sourceLine" id="cb1-2" title="2">    </a>
<a class="sourceLine" id="cb1-3" title="3">    <span class="kw">def</span> initial_transition(<span class="va">self</span>, timers):</a>
<a class="sourceLine" id="cb1-4" title="4">        <span class="co"># define your initial transition here</span></a>
<a class="sourceLine" id="cb1-5" title="5"></a>
<a class="sourceLine" id="cb1-6" title="6">    <span class="kw">def</span> transition(<span class="va">self</span>, state, event, timers):</a>
<a class="sourceLine" id="cb1-7" title="7">        <span class="co"># define your transitions here</span></a>
<a class="sourceLine" id="cb1-8" title="8"></a>
<a class="sourceLine" id="cb1-9" title="9">stm <span class="op">=</span> Dispenser()</a>
<a class="sourceLine" id="cb1-10" title="10">stm.run()</a></code></pre></div>
</div>
<p><strong>Task:</strong> Document the solution of your dispenser as detailed as possible, to explain to the reader how it works. Include a comic-like sequence of screenshots, too.</p>

    </section>
</div>
      </div>




    </div>

  </main>
<nav class="navbar navbar-expand-lg navbar-dark fixed-bottom" style="background-color: #555555">
    <div class="container-fluid">
      <div class="collapse navbar-collapse" id="navbarNavDropdown">
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link" href="https://www.ntnu.no/informasjonskapsler">Om informasjonskapsler</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="https://www.ntnu.no/personvern">Personvern</a>
          </li>
        </ul>
        <div class="bg-light ms-auto border-0"></div>
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link" data-bs-toggle="offcanvas" href="#offcanvasExample" role="button" aria-controls="offcanvasExample">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pencil-square" viewBox="0 0 16 16">
                <path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"/>
                <path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z"/>
              </svg>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </nav>
  <div class="offcanvas offcanvas-end text-bg-dark" tabindex="-1" id="offcanvasExample" aria-labelledby="offcanvasExampleLabel">
    <div class="offcanvas-header">
      <h5 class="offcanvas-title" id="offcanvasExampleLabel">Edit this page</h5>
    </div>
    <div class="offcanvas-body">
      <ul>
        <li>This site is hosted on <a href="https://github.com/falkr/ttm4175">Github</a></li>
        <li>The source is written in <a href="../supermark/index.html">Supermark</a> syntax</li>
        <li>To edit this page, make a commit to <a href="https://github.com/falkr/ttm4175/tree/master/pages/unit-p2/teamwork-1.md">this file</a></li>
      </ul>
    </div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
    crossorigin="anonymous"></script>
  <script>
    anchors.add('h1').add('h2').add('h3');
    anchors.options.visible = 'always';
    var clipboard = new ClipboardJS('.copy-button');
  </script>
  <script>
    



  </script>
</body>

</html>