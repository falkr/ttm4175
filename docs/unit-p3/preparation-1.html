<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="">
  <meta name="generator" content="">
  <title>TTM4175</title>
  <link rel="canonical" href="https://edu.iik.ntnu.no">
  <!-- Bootstrap core CSS -->
  <link href="../assets/bootstrap.min.css" rel="stylesheet">
  <!-- Custom styles for this template -->
  <link href="../assets/style-frame.css" rel="stylesheet">
  <link href="../assets/style-fonts.css" rel="stylesheet">
  <link href="../assets/style-code.css" rel="stylesheet">
  <link rel="stylesheet" href="../assets/bootstrap-icons.css">
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
    integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
    crossorigin="anonymous"></script>
  <script src="../assets/anchor.js"></script>
  <script src="../assets/clipboard.min.js"></script>
  <script src="../assets/script-aside.js"></script>
  <style>/* === figure === */
div.figure {
  padding: 20px 0 20px 0;
  width: 100%;
}

div.figurefullwitdth {
  padding: 20px 0 20px 0;
  margin-left: -33px;
  margin-right: -33px;
  width: 100%;
}

figcaption {
  color: #868279;
}

</style>
</head>

<body>





  <nav class="navbar navbar-expand-lg navbar shadow-sm">
    <div class="container-fluid">
      <a class="navbar-brand" href="https://ntnu.edu" title="NTNU Homepage">
        <img id="header_logo" alt="NTNU Hjemmeside" width="120"
          src="https://www.ntnu.no/o/ntnu-theme/images/logo_ntnu.svg" height="23">
      </a>

      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown"
        aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-list"
            viewBox="0 0 16 16">
            <path fill-rule="evenodd"
              d="M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5z" />
          </svg>
        </span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNavDropdown">
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link" href="../index.html">TTM4175</a>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              Teknostart
            </a>
            <ul class="dropdown-menu dropdown-menu">
              <li><a class="dropdown-item" href="../teknostart/index.html">Teknostart oversikt</a></li>
              <li>
                <div class="dropdown-divider"></div>
              </li>
              <li><a class="dropdown-item" href="../teknostart/day1.html">Teknostart Dag 1</a></li>
              <li><a class="dropdown-item" href="../teknostart/day2.html">Teknostart Dag 2</a></li>
              <li><a class="dropdown-item" href="../teknostart/day3.html">Teknostart Dag 3</a></li>
              <li><a class="dropdown-item" href="../teknostart/day4.html">Teknostart Dag 4</a></li>
            </ul>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              Units
            </a>
            <ul class="dropdown-menu dropdown-menu">
              <a class="dropdown-item" href="../units.html">Oversikt</a>
              <div class="dropdown-divider"></div>
              <a class="dropdown-item" href="../unit-cli/index.html">Linux CLI</a>
              <a class="dropdown-item" href="../unit-net1/index.html">IPs, LAN</a>
              <a class="dropdown-item" href="../unit-net2/index.html">Ports, Web Servers</a>
              <a class="dropdown-item" href="../unit-net3/index.html">Routing, DNS</a>
              <a class="dropdown-item" href="../unit-p1/index.html">IoT and the Microbit</a>
              <a class="dropdown-item" href="../unit-p2/index.html">State Machines</a>
              <a class="dropdown-item" href="../unit-p3/index.html">HTTP and JSON</a>
              <a class="dropdown-item" href="../unit-p4/index.html">MQTT</a>
            </ul>
          </li>



          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              Learning
            </a>
            <ul class="dropdown-menu dropdown-menu">
              <li><a class="dropdown-item" href="../learning/learning.html">LÃ¦ring</a></li>
              <li><a class="dropdown-item" href="../learning/reports.html">Rapporter</a></li>
            </ul>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              Tools
            </a>
            <ul class="dropdown-menu dropdown-menu">
              <li><a class="dropdown-item" href="../tools/index.html">Tools</a></li>
              <!--<li><a class="dropdown-item" href="../tools/tools-python.html">Python</a></li>-->
              <li><a class="dropdown-item" href="../tools/tools-gui.html">GUIs in Python</a></li>
              <li><a class="dropdown-item" href="../tools/tools-mqtt.html">MQTT</a></li>
              <li><a class="dropdown-item" href="../tools/tools-notebooks.html">Notebooks</a></li>
              <li><a class="dropdown-item" href="../tools/tools-stmpy.html">STMPY</a></li>
            </ul>
          </li>
        </ul>
        <div class="bg-light border ms-auto"></div>
        <div>
          <a class="nav-link" href="../schedule.html"><svg xmlns="http://www.w3.org/2000/svg" width="16"
              height="16" fill="currentColor" class="bi bi-calendar3" viewBox="0 0 16 16">
              <path
                d="M14 0H2a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2zM1 3.857C1 3.384 1.448 3 2 3h12c.552 0 1 .384 1 .857v10.286c0 .473-.448.857-1 .857H2c-.552 0-1-.384-1-.857V3.857z" />
              <path
                d="M6.5 7a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm-9 3a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm-9 3a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2z" />
            </svg></a>
        </div>
      </div>
    </div>
  </nav>

  <main class="container container-max-width">
    <nav style="--bs-breadcrumb-divider: url(&#34;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E&#34;);" aria-label="breadcrumb">
<ol class="breadcrumb">
<li class="breadcrumb-item"><a href="../breadcrumbs.txt/unit-p3/preparation-1.html">Preparation 1</a></li>
</ol>
</nav>
<section class="mt-2 mb-5 py-3">
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><h1>HTTP and JSON</h1>
</div><aside class="col-md-4 chunk ps-2"></aside></div>
</section>
<section class="mt-2 mb-5 py-3">
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><h1>Example: A Smart Home System</h1>
<p>Let's first look at an example system. Two weeks ago you learned how to
connect the Sense HAT and the Raspberry Pi to a Python program, so that
you could read values from the Sense HAT and also turn on its LEDs.
Imagine now that this Raspberry Pi is part of a system you want to
install at home, for instance to check the temperature while you are
away, and maybe switch on the heater before you arrive home. The sensors
report their values to a server. Since this server is somewhere in a
data center, we say that it's running <em>in the cloud.</em> The sensors report
their values periodically to the server, and the server keeps track of
the values sent. When we want to know the temperature at home, we can
simply ask the web server with a browser to present us the last measured
temperature value.</p>
</div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><figure class="figure">
    <img src="figures/smart-home.png" class="figure-img img-fluid rounded" alt="An example system with a temperature sensor that sends its measurements to a server. Users can check the temperature by accessing a website published by the server">
</figure></div><aside class="col-md-4 chunk ps-2"><figcaption class="figure-caption">An example system with a temperature sensor that sends its measurements to a server. Users can check the temperature by accessing a website published by the server</figcaption></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><p>During this week, we want to implement such a system, with the Raspberry
Pi and Sense HAT as our sensor, and another Raspberry Pi as the web
server. For this, we need several elements:</p>
<ul>
<li>We need to know more about the WWW and the HTTP protocol.</li>
<li>We need to transform data so we can send it.</li>
<li>We need to build a web server in Python.</li>
</ul>
<p><strong>Think a bit:</strong> What can be some benefits of using HTTP, a web server
and a browser as elements in this system?</p>
</div><aside class="col-md-4 chunk ps-2"></aside></div>
</section>
<section class="mt-2 mb-5 py-3">
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><h1>Sequence Diagrams and Message Patterns</h1>
<p>From today on we start to think a bit more about the patterns of
interactions between computers, that is, in which sequence they send
messages between each other. For that, we use a special type of diagram,
called <strong>sequence diagram</strong>. Below you see a very simple one. The
vertical lines (top to bottom) are called <em>lifelines</em> and define a
computer or any other communicating element. The box at the start of the
lifeline describes what the lifeline represents. Here, we just apply
role names, and call one of them <em>sender</em> and the other one <em>receiver</em>.
The horizontal arrow represents a message that travels between the
computers.</p>
</div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><figure class="figure">
    <img src="figures/single-message.svg" class="figure-img img-fluid rounded" alt="">
</figure></div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><p>Messages can be lost, for instance when somebody plugs out a cable,
disturbs the wireless signal or when some part of the network in between
fails. We can show that a message is lost by letting it run into a big
cross:</p>
</div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><figure class="figure">
    <img src="figures/single-message.svg" class="figure-img img-fluid rounded" alt="">
</figure></div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><p>The above interaction follows a simple patternthat we call <strong>single
message.</strong> As you can see, a problem with this message pattern is that
messages can get lost, and neither the sender nor the receiver detect
it. For that reason, we often use other message patterns or build
applications so that they can handle message losses. The next pattern we
are going to look at is already an improvement.</p>
</div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><h2>The Request-Response Message Pattern</h2>
<p>Another message pattern is <strong>request-response</strong>, shown in the diagram
below. It is used when one computer (the <em>requestor</em>) wants to get some
information from another one (the <em>responder</em>).</p>
</div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><figure class="figure">
    <img src="figures/request-response.svg" class="figure-img img-fluid rounded" alt="">
</figure></div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><p>Another benefit of the request-response pattern is that the requestor
knows that the responder has received the request once it receives the
response. Therefore, we often use a request-response pattern even when
we are not interested in the content of the response, just to be sure
that the original request has ben sent. The response in this case is
also called <em>acknowledgement</em>, and the entire pattern is called a
<em>handshake</em>. In case the requestor does not receive a response within
some time, it can for instance try again and send another request. To
sum up, the request-response pattern is used in two cases:</p>
<ul>
<li>
<p>When the requestor needs some data from the responder, i.e., when
the requestor wants to know something.</p>
</li>
<li>
<p>When the requestor only wants to tell something to the responder,
but wants to know of the responder actually received the data.</p>
</li>
</ul>
</div><aside class="col-md-4 chunk ps-2"></aside></div>
</section>
<section class="mt-2 mb-5 py-3">
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><h1>WWW -- The World Wide Web</h1>
</div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><p>Many people do not distinguish between the <em>Internet</em> and the <em>World Wide Web</em>.
The two are, however, quite different: The <em>Internet</em>, as
you have learned by now, is a system of interconnected computer networks
that communicate via IP and enable services like email, video streaming,
or internet telephony. It also enables the <em>World Wide Web</em>, which is a
collection of documents that you can access from specific servers.</p>
</div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><h2>The Client-Server Model</h2>
<p>When you access a website, this involves an interaction between two
computers: The web server that stores the website, and your computer
with a web browser that acts as a client.</p>
</div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><figure class="figure">
    <img src="figures/client-server.svg" class="figure-img img-fluid rounded" alt="">
</figure></div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><p>Both the client and the server are computers, but within this
interaction model they behave quite different: The server doesn't know
anything about the clients before they connect, and just waits for
clients. Once a client makes a request, it answers this request with a
response. The server <em>serves</em> the request. In the basic case of serving
a website, the server only reacts on the requests. All interactions are
initiated (started) by the client.</p>
<p>Often, servers are powerful machines, running in a data center and
serving many clients. But that is not always the case. A server can also
be a tiny computer, serving only a single or a few other clients. The
term <em>client-server</em> only refers to the roles they have in the
interactions: the client takes initiative and the server responds.</p>
</div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><h2>HTTP</h2>
<p>Once two computers communicate, we have to ensure that they understand
each other. This is where protocols come in. They define a set of rules
that all partners have to follow. You already know something about the
<em>Internet Protocol</em>, IP. This protocol defines how we can send data
packages between computers connected networks that together make up the
Internet. TCP is a protocol that is used to control IP packets, so that
they arrive in a particular order and are resubmitted when they get
lost.</p>
<p>Sending data packets does not yet ensure that computers can actually
understand the data. This is why there are protocols defined on top of
TCP and IP, for the different types of applications that we want to use
on the internet. For accessing websites, this protocol is HTTP, or
<em>Hypertext Transfer Protocol</em>. HTTP is based on a pattern that is called
request-response, meaning that all interactions consist of a request
message, sent by the client, and a corresponding response, sent by the
server. To get a website, the request looks as follows:</p>
<pre><code>GET /index.html HTTP/1.1
Host: www.example.com
</code></pre>
<p>Note that the keyword <code>GET</code> shows that the browser would like to access
a resource. It is followed by <code>/index.html</code>, which is the path of the
website we would like to read. The corresponding response can look like
this:[^3]</p>
<pre><code>HTTP/1.1 200 OK
Date: Mon, 23 May 2005 22:38:34 GMT
Content-Type: text/html; charset=UTF-8
Content-Length: 138
Last-Modified: Wed, 08 Jan 2003 23:11:55 GMT
Server: Apache/1.3.3.7 (Unix) (Red-Hat/Linux)
ETag: &quot;3f80f-1b6-3e1cb03b&quot;
Accept-Ranges: bytes
Connection: close

&lt;html&gt;
&lt;head&gt;
  &lt;title&gt;An Example Page&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
  Hello World, this is a very simple HTML document.
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>The answer indicates the HTTP version, followed by the token <code>200 OK</code>,
which means that the response actually contains the requested
information. When a site is not accessible, the code is a
<code>404 Not Found</code>, which you may have seen when browsing the web.
Following the header information is the actual content of the document
we want to access. Here, it is a HTML site, beginning with the <code>&lt;html&gt;</code>
tag. This language describes websites with some markup, so that you can
have tables and arrange all sorts of elements and render them in a
browser. So when you request a website, it's basically these two
messages that are exchanged between your browser (the client) and the
web server.</p>
</div><aside class="col-md-4 chunk ps-2"></aside></div>
</section>
<section class="mt-2 mb-5 py-3">
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><h1>Web Server in Python</h1>
<p>It's simple to create a web server in Python.</p>
</div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><figure class="figure">
    <img src="figures/python-server.svg" class="figure-img img-fluid rounded" alt="">
</figure></div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><p>Of course, much of the code running the server is hidden in libraries,
but our code controls some interesting parts of the server.</p>
<ol>
<li>
<p>We define a class <code>RequestHandler</code>. This class has the only task to
define how we answer a request.</p>
</li>
<li>
<p>When a request comes to the web server, the method <code>do_GET(self)</code> is
called by the server. In this method we can compute our response. In
this case, we return response code <code>200</code> (which means OK), set the
content type in the header, and then set the content to be
<code>Hello World</code>. We encode the string into bytes, using Unicode
<code>utf-8</code> encoding.</p>
</li>
<li>
<p>These lines start the actual server. We create an instance of the
class <code>HTTPServer</code> and then tell it to start.</p>
</li>
</ol>
<p>Don't worry too much about some of the code here, but focus on the
<code>do_GET()</code> method, which gets called once the request arrives and then
computes an answer.</p>
</div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><p>[^3]: These code snippets are taken from
<a href="https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#HTTP_session_state">https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#HTTP_session_state</a></p>
</div><aside class="col-md-4 chunk ps-2"></aside></div>
</section>
  </main>



  <nav class="navbar navbar-expand-lg navbar-dark fixed-bottom" style="background-color: #555555">
    <div class="container-fluid">
      <div class="collapse navbar-collapse">
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link" href="https://www.ntnu.no/informasjonskapsler">Om informasjonskapsler</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="https://www.ntnu.no/personvern">Personvern</a>
          </li>
        </ul>
        <div class="bg-light ms-auto border-0"></div>
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link" data-bs-toggle="offcanvas" href="#offcanvasExample" role="button"
              aria-controls="offcanvasExample">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                class="bi bi-pencil-square" viewBox="0 0 16 16">
                <path
                  d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z" />
                <path fill-rule="evenodd"
                  d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z" />
              </svg>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </nav>
  <div class="offcanvas offcanvas-end text-bg-dark" tabindex="-1" id="offcanvasExample"
    aria-labelledby="offcanvasExampleLabel">
    <div class="offcanvas-header">
      <h5 class="offcanvas-title" id="offcanvasExampleLabel">Edit this page</h5>
    </div>
    <div class="offcanvas-body">
      <ul>
        <li>This site is hosted on <a href="https://github.com/falkr/ttm4175">Github</a></li>
        <li>The source is written in <a href="../supermark/index.html">Supermark</a> syntax</li>
        <li>To edit this page, make a commit to <a
            href="https://github.com/falkr/ttm4175/tree/master/pages/unit-p3/preparation-1.md">this file</a></li>
      </ul>
    </div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
    crossorigin="anonymous"></script>
  <script>
    anchors.add('h1').add('h2').add('h3');
    anchors.options.visible = 'always';
    var clipboard = new ClipboardJS('.copy-button');
  </script>
  <script>
</script>
</body>

</html>